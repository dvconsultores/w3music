(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7d834add"],{7338:function(t,e,a){t.exports=a.p+"img/back.33c74cab.svg"},a8d7:function(t,e,a){"use strict";a.d(e,"a",(function(){return c}));var s=a("2881"),i=(a("d799"),a("71b3"),a("36f8"),{apiKey:"AIzaSyD3A4gu6KMPj3jyoUDpmv6xCfk2JcuvBmA",authDomain:"w3music-39365.firebaseapp.com",projectId:"w3music-39365",storageBucket:"w3music-39365.appspot.com",messagingSenderId:"588067526382",appId:"1:588067526382:web:5ef70c9d51abb60763c5ff",measurementId:"G-7EJ4M99T5T"});s["a"].initializeApp(i);var c=s["a"].firestore()},c847:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"divcol margin_global gap2 isolate",attrs:{id:"chats"}},[s("v-menu",{attrs:{activator:"#emojiPickerBtn","close-on-content-click":!1,top:"",left:""}},[s("VEmojiPicker",{attrs:{id:"emojiPicker"},on:{select:t.selectEmoji}})],1),s("section",{staticClass:"container-header divcol",staticStyle:{gap:"2em"}},[s("img",{staticClass:"pointer back",staticStyle:{"--w":"100px"},attrs:{src:a("7338"),alt:"back"},on:{click:function(e){return t.Back()}}}),t._m(0)]),s("section",{staticClass:"container-content grid",staticStyle:{"--gtc":"repeat(auto-fit,minmax(min(100%,24.4375em),1fr))",gap:"clamp(3em, 5vw, 4em)"},attrs:{id:"desktop"}},[s("section",{staticClass:"divcol gap2",attrs:{id:"section-left"}},[s("aside",{staticClass:"container-actions acenter gap2 font2",staticStyle:{height:"2.75em"}},[s("v-text-field",{staticStyle:{"max-width":"20ch"},attrs:{placeholder:"Search","hide-details":"",solo:""},on:{input:function(e){return t.searchChats()}},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),s("v-btn",{staticStyle:{"--bg":"var(--primary)","--p":"1.4em"},attrs:{icon:""},on:{click:function(e){return t.searchChats()}}},[s("img",{staticStyle:{"--w":"1.5625em"},attrs:{src:a("fe80"),alt:"search button"}})])],1),s("aside",{staticClass:"divcol isolate relative"},t._l(t.dataChats,(function(e,a){return s("v-card",{key:a,staticClass:"chat card space font2",class:{active:e.active},on:{click:function(a){t.dataChats.forEach((function(t){t.active=!1})),e.active=!0,t.SelectChat(e)}}},[s("div",{staticClass:"acenter gap1"},[s("img",{staticStyle:{"--w":"4em","--br":"50%"},attrs:{src:e.img,alt:"profile image"}}),s("div",{staticClass:"divcol"},[s("h6",{staticClass:"p font2"},[t._v(t._s(e.artist))])])]),s("div",{staticClass:"divcol bold",staticStyle:{gap:".1em"}},[s("span",[t._v(t._s(e.ago?t.convertDate(e.ago):null))])])])})),1)]),s("section",{staticClass:"divcol gap1",attrs:{id:"section-right"}},[s("aside",{staticClass:"space gap1",staticStyle:{width:"min(100%, 40em)"}},[s("div",{staticClass:"acenter gap1"},[s("img",{staticStyle:{"--br":"50%","--w":"4em"},attrs:{src:t.activeChat.img||"",alt:"profile image"}}),s("h3",{staticClass:"p",staticStyle:{"font-size":"2em"}},[t._v(t._s(t.activeChat.artist||""))])])]),s("aside",{attrs:{id:"content-chat"}},t._l(t.chat,(function(e,a){return s("blockquote",{key:a},[s("v-card",{staticClass:"card font2",class:{user:t.wallet==e.wallet}},[s("p",{directives:[{name:"show",rawName:"v-show",value:e.content,expression:"item.content"}],staticClass:"p"},[t._v(t._s(e.content))]),s("img",{directives:[{name:"show",rawName:"v-show",value:e.emoji,expression:"item.emoji"}],attrs:{src:e.emoji,alt:"emoji"}}),s("span",{staticClass:"bold",attrs:{id:"ago"}},[t._v(t._s(t.convertDate(e.created)))])])],1)})),0),s("aside",{staticClass:"space gap1",attrs:{id:"control-chat"}},[s("v-text-field",{staticStyle:{"--c-place":"#000000","--b":"1.5px solid #000000"},attrs:{solo:"","hide-details":"",placeholder:"Message"},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendMessage.apply(null,arguments)}},scopedSlots:t._u([{key:"prepend-inner",fn:function(){return[s("v-icon",{staticClass:"pointer",attrs:{id:"emojiPickerBtn"}},[t._v("mdi-emoticon-outline")])]},proxy:!0}]),model:{value:t.messageContent,callback:function(e){t.messageContent=e},expression:"messageContent"}}),s("v-btn",{staticStyle:{"--b":"1px solid #000000","--p":"1.3em"},attrs:{icon:""}},[s("v-icon",{staticStyle:{color:"#000000"},attrs:{disabled:!t.messageContent},on:{click:function(e){return t.sendMessage()}}},[t._v("mdi-send")])],1)],1)])]),s("section",{staticClass:"container-content grid",staticStyle:{"--gtc":"repeat(auto-fit,minmax(min(100%,24.4375em),1fr))",gap:"clamp(3em, 5vw, 4em)"},attrs:{id:"mobile"}},[t.activeChat.state?s("section",{staticClass:"divcol gap1",attrs:{id:"section-right"}},[s("aside",{staticClass:"space gap1",staticStyle:{width:"min(100%, 40em)"}},[s("div",{staticClass:"acenter gap1"},[s("img",{staticStyle:{"--br":"50%","--w":"4em"},attrs:{src:t.activeChat.img||"",alt:"profile image"}}),s("h3",{staticClass:"p",staticStyle:{"font-size":"2em"}},[t._v(t._s(t.activeChat.artist||""))])])]),s("aside",{attrs:{id:"content-chat"}},t._l(t.chat,(function(e,a){return s("blockquote",{key:a},[s("v-card",{staticClass:"card font2",class:{user:t.wallet==e.wallet}},[s("p",{directives:[{name:"show",rawName:"v-show",value:e.content,expression:"item.content"}],staticClass:"p"},[t._v(t._s(e.content))]),s("img",{directives:[{name:"show",rawName:"v-show",value:e.emoji,expression:"item.emoji"}],attrs:{src:e.emoji,alt:"emoji"}}),s("span",{staticClass:"bold",attrs:{id:"ago"}},[t._v(t._s(t.convertDate(e.created)))])])],1)})),0),s("aside",{staticClass:"space gap1",attrs:{id:"control-chat"}},[s("v-text-field",{staticStyle:{"--c-place":"#000000","--b":"1.5px solid #000000"},attrs:{solo:"","hide-details":"",placeholder:"Message"},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendMessage.apply(null,arguments)}},scopedSlots:t._u([{key:"prepend-inner",fn:function(){return[s("v-icon",{staticClass:"pointer",attrs:{id:"emojiPickerBtn"}},[t._v("mdi-emoticon-outline")])]},proxy:!0}]),model:{value:t.messageContent,callback:function(e){t.messageContent=e},expression:"messageContent"}}),s("v-btn",{staticStyle:{"--b":"1px solid #000000","--p":"1.3em"},attrs:{icon:""}},[s("v-icon",{staticStyle:{color:"#000000"},attrs:{disabled:!t.messageContent},on:{click:function(e){return t.sendMessage()}}},[t._v("mdi-send")])],1)],1)]):s("section",{staticClass:"divcol gap2",attrs:{id:"section-left"}},[s("aside",{staticClass:"container-actions acenter gap2 font2",staticStyle:{height:"2.75em"}},[s("v-text-field",{staticStyle:{"max-width":"20ch"},attrs:{placeholder:"Search","hide-details":"",solo:""},on:{input:function(e){return t.searchChats()}},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),s("v-btn",{staticStyle:{"--bg":"var(--primary)","--p":"1.4em"},attrs:{icon:""},on:{click:function(e){return t.searchChats()}}},[s("img",{staticStyle:{"--w":"1.5625em"},attrs:{src:a("fe80"),alt:"search button"}})])],1),s("aside",{staticClass:"divcol isolate relative"},[t._l(t.dataChats,(function(e,a){return s("v-card",{key:a,staticClass:"chat card space font2",class:{active:e.active},on:{click:function(a){t.dataChats.forEach((function(t){t.active=!1})),e.active=!0,t.SelectChat(e)}}},[s("div",{staticClass:"acenter gap1"},[s("img",{staticStyle:{"--w":"4em","--br":"50%"},attrs:{src:e.img,alt:"profile image"}}),s("div",{staticClass:"divcol"},[s("h6",{staticClass:"p font2"},[t._v(t._s(e.name))]),s("span",{staticClass:"preview-text"},[t._v(t._s(e.previewText))])])]),s("div",{staticClass:"divcol bold",staticStyle:{gap:".1em"}},[s("span",[t._v(t._s(e.ago?t.convertDate(e.ago):null))]),s("v-chip",{attrs:{color:"var(--primary)"}},[t._v(t._s(e.messages))])],1)])})),s("v-btn",{staticStyle:{"--bg":"var(--primary)","--p":"1.4em","--bs":"0px 4px 4px rgba(0, 0, 0, 0.25)"},attrs:{id:"new-chats",icon:""}},[s("img",{staticStyle:{"--w":"1.9375em"},attrs:{src:a("e653"),alt:"new chat"}})])],2)])])],1)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"divcol"},[a("span",{staticClass:"font2"},[t._v("CHATS")]),a("h1",{staticClass:"p"},[t._v("KEEP CLOSE")])])}],c=a("3835"),n=a("5530"),r=a("1da1"),o=(a("96cf"),a("ac1f"),a("841c"),a("4de4"),a("d3b7"),a("caad"),a("2532"),a("159b"),a("4fadc"),a("c1df")),l=a.n(o),d=a("a8d7"),u=a("79b5"),m=a("d9eb"),p=m["Contract"],h={name:"chats",components:{VEmojiPicker:u["a"]},data:function(){return{search:null,wallet:null,messageContent:"",activeChat:null,chat:[],dataActions:{key:"by",value:"RECENT",active:!1,data:["RECENT","LATEST","POPULAR"],archived:!1},dataChatsAux:[],dataChats:[]}},mounted:function(){this.$emit("RouteValidator"),this.wallet=this.$ramper.getAccountId()||this.$selector.getAccountId(),this.getChats(),console.log("FIREEE",d["a"])},methods:{searchChats:function(){var t=this;console.log(this.search),this.dataChats=this.dataChatsAux.filter((function(e){return e.artist.toLowerCase().includes(t.search.toLowerCase())}))},selectEmoji:function(t){this.messageContent=this.messageContent+t.data},convertDate:function(t){return l()(t).format("HH:mm")},getChats:function(){var t=this;this.dataChats=[],d["a"].collection("TESTNET").onSnapshot((function(e){var a=[];e.forEach(function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(s){var i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.t0=n["a"],e.t1=Object(n["a"])({},s.data()),e.t2={},e.t3=s.id,e.next=6,t.getNearSocial(s.id);case 6:e.t4=e.sent,e.t5={id:e.t3,img:e.t4},c=(0,e.t0)(e.t1,e.t2,e.t5),console.log(c),t.activeChat||"w3music"===c.id&&(c.active=!0,t.SelectChat(c)),(null===(i=t.activeChat)||void 0===i?void 0:i.id)===c.id&&(c.active=!0),a.push(c);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.dataChats=a,t.dataChatsAux=a}))},getNearSocial:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var s,i,n,r,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if("w3music"!==t){a.next=2;break}return a.abrupt("return","https://bafkreihdn254nyl5cnj7unjul4mjnp6lqrrme5a4gd6zm5ppnw7iyhxh3y.ipfs.nftstorage.link/");case 2:return a.next=4,e.$near.account(t);case 4:return s=a.sent,i=new p(s,"v1.social08.testnet",{viewMethods:["get"],sender:s}),n=[s.accountId+"/profile/**"],a.next=9,i.get({keys:n});case 9:return r=a.sent,o="",Object.entries(r).forEach((function(t){var e=Object(c["a"])(t,2),a=(e[0],e[1]);o="https://ipfs.near.social/ipfs/"+a.profile.image.ipfs_cid})),a.abrupt("return",o);case 13:case"end":return a.stop()}}),a)})))()},Back:function(){window.innerWidth<=1128&&this.activeChat.state?this.activeChat.state=!1:this.$router.push("/home")},SelectChat:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:e.activeChat=t,e.getMessages(t),window.innerWidth<=1128&&(e.activeChat.state=!0);case 3:case"end":return a.stop()}}),a)})))()},getMessages:function(t){var e=this;d["a"].collection("TESTNET").doc(t.id).collection("MESSAGES").orderBy("created").onSnapshot((function(t){var a=[];t.forEach((function(t){var e=Object(n["a"])(Object(n["a"])({},t.data()),{},{id:t.id,active:!1});console.log(e),a.push(e)})),e.chat=a}))},sendMessage:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log(t.messageContent),!t.messageContent){e.next=13;break}return e.t0=t.$ramper.getAccountId()||t.$selector.getAccountId(),e.next=5,t.getNearSocial(t.$ramper.getAccountId()||t.$selector.getAccountId());case 5:e.t1=e.sent,e.t2=t.messageContent,e.t3=Date.now(),a={wallet:e.t0,avatar:e.t1,content:e.t2,created:e.t3},d["a"].collection("TESTNET").doc(t.activeChat.id).collection("MESSAGES").add(a),d["a"].collection("TESTNET").doc(t.activeChat.id).set({artist:t.activeChat.artist||"",ago:Date.now()}),t.getMessages(t.activeChat),t.messageContent="";case 13:case"end":return e.stop()}}),e)})))()}}},v=h,g=(a("fa65"),a("2877")),f=a("6544"),C=a.n(f),w=a("8336"),b=a("b0af"),y=a("cc20"),S=a("132d"),k=a("e449"),x=a("8654"),_=Object(g["a"])(v,s,i,!1,null,null,null);e["default"]=_.exports;C()(_,{VBtn:w["a"],VCard:b["a"],VChip:y["a"],VIcon:S["a"],VMenu:k["a"],VTextField:x["a"]})},d80c:function(t,e,a){},e653:function(t,e,a){t.exports=a.p+"img/new-chat.63b1b20f.svg"},fa65:function(t,e,a){"use strict";a("d80c")},fe80:function(t,e,a){t.exports=a.p+"img/lupa.7115034a.svg"}}]);
//# sourceMappingURL=chunk-7d834add.7a223bff.js.map